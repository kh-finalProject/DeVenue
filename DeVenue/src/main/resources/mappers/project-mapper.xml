<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace ="projectMapper">

<resultMap type="Project" id="projectResultSet">
		<id property="proId" column="PRO_ID"/>
		<result property="memId" column="MEM_ID"/>
		<result property="proName" column="PRO_NAME"/>
		<result property="proMaintain" column="PRO_MAINTAIN"/>
		<result property="proStaId" column="PRO_STA_ID"/>
		<result property="proRecruit" column="PRO_RECRUIT"/>
		<result property="proCreateDate" column="PRO_CREATE_DATE"/>
		<result property="proPlan" column="PRO_PLAN"/>
		<result property="proPlanDetail" column="PRO_PLANDETAIL"/>
		<result property="proSummary" column="PRO_SUMMARY"/>	
		<result property="proNeeds" column="PRO_NEEDS"/>	
		<result property="proNeedsDetail" column="PRO_NEEDSDETAIL"/>	
		<result property="proResource" column="PRO_RESOURCE"/>	
		<result property="proPayment" column="PRO_PAYMENT"/>	
		<result property="proStartDate" column="PRO_START_DATE"/>	
		<result property="proDuration" column="PRO_DURATION"/>	
		<result property="proREndDate" column="PRO_R_END_DATE"/>	
		<result property="proEndDate" column="PRO_END_DATE"/>	
		<result property="proMCId" column="MC_ID"/>	
		<result property="proDCId" column="DC_ID"/>	
		<result property="proWTId" column="WT_ID"/>	
		<result property="proRecruitNum" column="PRO_RECRUIT_NUM"/>	
		<result property="proPlanPaper" column="PRO_PLAN_PAPER"/>
		<result property="proPlanRePaper" column="PRO_PLAN_REPAPER"/>
		<result property="proLocation" column="PRO_LOCATION"/>
		<result property="proHelp" column="PRO_HELP"/>
		<result property="proManage" column="PRO_MANAGE"/>
		<result property="proFuturePlan" column="PRO_FUTUREPLAN"/>
		<result property="proPriority" column="PRO_PRIORTY"/>
		<result property="proContract" column="PRO_CONTRACT"/>
		<result property="proTypeCode" column="MEM_TYPE_CODE"/>
		<result property="proWorkspace" column="PRO_WORKPLACE"/>
		<result property="proSignId" column="SIG_ID"/>
		<result property="proPayStatus" column="PRO_PAY_STATUS"/>
		<result property="proParentId" column="PRO_PARENT_ID"/>
		<result property ="proMCType" column = "MC_TYPE"/>
		<result property ="proDCType" column ="DC_TYPE"/>
		<result property ="proMTK" column ="MEM_TYPE_KIND"/>
		
		
	</resultMap>
	
	<resultMap type="ProjectQuestion" id="projectQuestionResultSet">
		<id property ="proAQId" column ="PRO_AQ_ID"/>
		<result property ="proAQContent" column="PRO_AQ_CONTENT"/>
		<result property ="proAQCDate" column ="PRO_AQC_DATE"/>
		<result property ="proId" column ="PRO_ID"/>
		
		
	</resultMap>
	
	<resultMap type ="ApplyConfirm" id ="applyConfirmResultSet">
		<id property ="proAId" column ="PRO_AID"/>
		<result property ="memPId" column ="MEM_PID"/>
		<result property ="proAPayment" column ="PRO_APAYMENT"/>
		<result property ="proADuration" column ="PRO_ADURATION"/>
		<result property ="proAContent" column ="PRO_ACONTENT"/>
		<result property ="proReAResume" column ="PRO_REARESUME"/>
		<result property ="proApplyDate" column ="PRO_APPLY_DATE"/>
		<result property ="memNick" column ="MEM_NICK"/>
		<result property ="memIntro" column ="INTRODUCTION"/>
		<result property ="memImg" column ="PROFILE_IMG"/>
		<result property ="portId" column ="PORT_ID"/>
	<association property="project" javaType="Project">
				<id property="proId" column="PRO_ID"/>
			</association>
	</resultMap>
	
	
	
	<resultMap type="ProjectList" id="projectListResultSet">
		<id property="id" column="ID"/>
		<result property="applyNum" column="APPLYNUM"/>
		<result property="likeNum" column="LIKENUM"/>
		<result property="replyNum" column="REPLYNUM"/>
		<result property="mCategory" column="MCATEGORY"/>
		<result property="dCategory" column="DCATEGORY"/>
		<result property="workType" column="WORKTYPE"/>
		<result property="identify" column="IDENTIFY"/>
		<result property="evaluation" column="EVALUATION"/>
		<result property="calculateStatus" column="CAL_STATUS"/>

	<association property="project" javaType="Project">
		<result property="proId" column="PROID"/>
		<result property="proName" column="NAME"/>
		<result property="proStaId" column="STATUS"/>
		<result property="proPlanDetail" column="PLANDETAIL"/>
		<result property="proDuration" column="DURATION"/>
		<result property="proSummary" column="SUMMARY"/>
		<result property="proPayment" column="PAYMENT"/>
		<result property="proLocation" column="LOCATION"/>
		<result property="proRecruit" column="RECRUIT"/>
		<result property="proCreateDate" column="CDATE"/>
		<result property="proREndDate" column="RENDDATE"/>
		<result property="proContract" column="CONTRACT"/>
		<result property="memId" column="CLIENTID"/>
	</association>	
				
	</resultMap>
	
	<resultMap type="Tech" id="techResultSet">
		<result property="pId" column="PRO_ID"/>
		<result property="tId" column="TECH_ID"/>
		<result property="tName" column="TECH_NAME"/>
	</resultMap>
	
	<resultMap type="ProjectDetail" id="detailResultSet">
		<id property="pId" column="ID"/>
		
		<association property="pList" javaType="ProjectList">
		<result property="applyNum" column="APPLYNUM"/>
		<result property="likeNum" column="LIKENUM"/>
		<result property="replyNum" column="REPLYNUM"/>
		<result property="mCategory" column="MCATEGORY"/>
		<result property="dCategory" column="DCATEGORY"/>
		<result property="workType" column="WORKTYPE"/>
		<result property="identify" column="IDENTIFY"/>
		<result property="evaluation" column="EVALUATION"/>
		
		<collection property="techName" javaType="java.util.ArrayList" resultMap="techResultSet"/>		
		</association>
		
		<association property="project" javaType="Project">
		<result property="memId" column="MEM_ID"/>
		<result property="proName" column="PRO_NAME"/>
		<result property="proMaintain" column="PRO_MAINTAIN"/>
		<result property="proStaId" column="PRO_STA_ID"/>
		<result property="proRecruit" column="PRO_RECRUIT"/>
		<result property="proCreateDate" column="PRO_CREATE_DATE"/>
		<result property="proPlan" column="PRO_PLAN"/>
		<result property="proPlanDetail" column="PRO_PLANDETAIL"/>
		<result property="proSummary" column="PRO_SUMMARY"/>	
		<result property="proNeeds" column="PRO_NEEDS"/>	
		<result property="proNeedsDetail" column="PRO_NEEDSDETAIL"/>	
		<result property="proResource" column="PRO_RESOURCE"/>	
		<result property="proPayment" column="PRO_PAYMENT"/>	
		<result property="proStartDate" column="PRO_START_DATE"/>	
		<result property="proDuration" column="PRO_DURATION"/>	
		<result property="proREndDate" column="PRO_R_END_DATE"/>	
		<result property="proRecruitNum" column="PRO_RECRUIT_NUM"/>	
		<result property="proPlanPaper" column="PRO_PLAN_PAPER"/>
		<result property="proPlanRePaper" column="PRO_PLAN_REPAPER"/>
		<result property="proLocation" column="PRO_LOCATION"/>
		<result property="proHelp" column="PRO_HELP"/>
		<result property="proManage" column="PRO_MANAGE"/>
		<result property="proFuturePlan" column="PRO_FUTUREPLAN"/>
		<result property="proPriority" column="PRO_PRIORTY"/>
		<result property="proContract" column="PRO_CONTRACT"/>
		<result property="proTypeCode" column="PRO_TYPE_CODE"/>
		</association>	
		
		<association property="profile" javaType="Profile">
		<result property="introduction" column="INTRODUCTION"/>
		</association>
		
		<association property="client" javaType="Member">
			<result property="memNick" column="CLIENTNICK"/>
		</association>
		
		<collection property="question" javaType="java.util.ArrayList" resultMap="questionResultSet"/>
		<collection property="rpList" javaType="java.util.ArrayList" resultMap="pReplyResultSet"/>
		<collection property="rcList" javaType="java.util.ArrayList" resultMap="cReplyResultSet"/>
		
	</resultMap>
	
	<resultMap type="Question" id="questionResultSet">
		<id property="proAQId" column="PRO_AQ_ID"/>
		<result property="proAQContent" column="PRO_AQ_CONTENT"/>
		<result property="proAQCDate" column="PRO_AQC_DATE"/>
	</resultMap>
	
	<resultMap type="Reply" id="pReplyResultSet">
		<id property="rId" column="RP_RID"/>
		<result property="pId" column="RP_PID"/>
		<result property="rContent" column="RP_CONTENT"/>
		<result property="rCreateDate" column="RP_CDATE"/>
		<result property="rModifyDate" column="RP_MDATE"/>
		<result property="rAnswerStatus" column="RP_RANSWER"/>
		<result property="rStatus" column="RP_STATUS"/>
		<result property="parentRId" column="RP_P_RID"/>
		<result property="rSecret" column="RP_SECRET"/>
		
		<association property="writer" javaType="Member">
			<id property="memId" column="RP_MID"/>
			<result property="memNick" column="RP_MNICK"/>
		</association>
			
	</resultMap>
	
	<resultMap type="Reply" id="cReplyResultSet">
		<id property="rId" column="RC_RID"/>
		<result property="pId" column="RC_PID"/>
		<result property="rContent" column="RC_CONTENT"/>
		<result property="rCreateDate" column="RC_CDATE"/>
		<result property="rModifyDate" column="RC_MDATE"/>
		<result property="rAnswerStatus" column="RC_RANSWER"/>
		<result property="rStatus" column="RC_STATUS"/>
		<result property="parentRId" column="RC_P_RID"/>
		<result property="rSecret" column="RC_SECRET"/>
		
		<association property="writer" javaType="Member">
			<id property="memId" column="RC_MID"/>
			<result property="memNick" column="RC_MNICK"/>
		</association>
			
	</resultMap>
	
	<resultMap type="projectDetail" id="pNumberResultSet">
		<result property="allProject" column="ALL"/>
		<result property="processProject" column="PROCESS"/>
		<result property="completeProject" column="COMPLETE"/>
		<result property="total" column="TOTAL"/>
		<result property="evalCount" column="EVALCOUNT"/>
	</resultMap>
	
	<resultMap type="ProjectList" id="RecommendResultSet">
		<id property="id" column="ID"/>
		<result property="applyNum" column="APPLYNUM"/>
		<result property="likeNum" column="LIKENUM"/>
		<result property="replyNum" column="REPLYNUM"/>
		<result property="mCategory" column="MCATEGORY"/>
		<result property="dCategory" column="DCATEGORY"/>
		<result property="workType" column="WORKTYPE"/>
		<result property="identify" column="IDENTIFY"/>
		<result property="evaluation" column="EVALUATION"/>

	<association property="project" javaType="Project">
		<result property="proName" column="NAME"/>
		<result property="proPlanDetail" column="PLANDETAIL"/>
		<result property="proDuration" column="DURATION"/>
		<result property="proSummary" column="SUMMARY"/>
		<result property="proPayment" column="PAYMENT"/>
		<result property="proLocation" column="LOCATION"/>
		<result property="proRecruit" column="RECRUIT"/>
		<result property="proCreateDate" column="CDATE"/>
		<result property="proREndDate" column="RENDDATE"/>
		<result property="memId" column="CLIENTID"/>
	</association>	
	
	<collection property="techName" javaType="java.util.ArrayList" resultMap="techResultSet"/>

	</resultMap>
	
	<resultMap type="Like" id="likeResultSet">
	
		<id property="proLId" column="PRO_LID"/>
		
		<association property="partner" javaType="Member">
			<id property="memId" column="MEM_ID"/>
			<result property="memNick" column="MEM_NICK"/>
			<result property="memEmail" column="MEM_EMAIL"/>
		</association>
		
		<association property="pList" javaType="ProjectList">
			<id property="id" column="ID"/>
			<result property="mCategory" column="MCATEGORY"/>
			<result property="dCategory" column="DCATEGORY"/>
			<result property="workType" column="WORKTYPE"/>
			<result property="identify" column="IDENTIFY"/>
			
			<association property="project" javaType="Project">
				<result property="proName" column="NAME"/>
				<result property="proDuration" column="DURATION"/>
				<result property="proSummary" column="SUMMARY"/>
				<result property="proPayment" column="PAYMENT"/>
				<result property="proLocation" column="LOCATION"/>
				<result property="proRecruit" column="RECRUIT"/>
				<result property="proCreateDate" column="CDATE"/>
				<result property="proREndDate" column="RENDDATE"/>
			</association>
			
		</association>
	
	</resultMap>
	
	<resultMap type="Pofo" id="portfolioResultSet">
		<id property="portId" column="PORT_ID"/>
		<result property="mCategory" column="MC_ID"/>
		<result property="dCategory" column="DC_ID"/>
		<result property="portName" column="PROT_NAME"/>
		<result property="portJoin" column="PORT_JOIN"/>
		<result property="portContent" column="PORT_CONTENT"/>
		<result property="startDate" column="PORT_START_DATE"/>
		<result property="endDate" column="PORT_END_DATE"/>
		
		<collection property="image" javaType="java.util.ArrayList" resultMap="imageResultSet"/>
	</resultMap>
	
	<resultMap type="Image" id="imageResultSet">
		<id property="imgId" column="PORT_IMG_ID"/>
		<result property="imgContent" column="PORT_IMG_CONTENT"/>
		
	</resultMap>
	
	<resultMap type="Answer" id="AnswerResultSet">
		<id property="aaId" column="PRO_AA_ID"/>
		<result property="aaContent" column="PRO_AA_CONTENT"/>
		<result property="aqId" column="PRO_AQ_ID"/>
		<result property="aqContent" column="PRO_AQ_CONTENT"/>
		<result property="aaCDate" column="PRO_AAC_DATE"/>
	
	</resultMap>
	
	<resultMap type="ApplyPF" id="applyPFResultSet">
		<id property="apId" column="AP_ID"/>
		<result property="portId" column="PORT_ID"/>
		<result property="apContent" column="AP_CONTENT"/>
		
		<association property="portfolio" javaType="Pofo">
		<result property="mCategory" column="MC_ID"/>
		<result property="dCategory" column="DC_ID"/>
		<result property="portName" column="PROT_NAME"/>
		<result property="portJoin" column="PORT_JOIN"/>
		<result property="startDate" column="PORT_START_DATE"/>
		<result property="endDate" column="PORT_END_DATE"/>
		</association>
		
	</resultMap>
	
	<resultMap type="Application" id="applyResultSet">
		<id property="aId" column="PRO_AID"/>
		<result property="aPayment" column="PRO_APAYMENT"/>
		<result property="aDuration" column="PRO_ADURATION"/>
		<result property="aContent" column="PRO_ACONTENT"/>
		<result property="originalResume" column="PRO_ARESUME"/>
		<result property="reNameResume" column="PRO_REARESUME"/>
		<result property="applyDate" column="PRO_APPLY_DATE"/>
		<result property="saveStatus" column="PRO_ASAVE_STATUS"/>
		<result property="status" column="PRO_ASTATUS"/>
			
		<association property="pList" javaType="ProjectList">
			<id property="id" column="ID"/>
			<result property="mCategory" column="MCATEGORY"/>
			<result property="dCategory" column="DCATEGORY"/>
			<result property="workType" column="WORKTYPE"/>
			<result property="identify" column="IDENTIFY"/>
			
			<association property="project" javaType="Project">
				<result property="proName" column="NAME"/>
				<result property="proDuration" column="DURATION"/>
				<result property="proSummary" column="SUMMARY"/>
				<result property="proPayment" column="PAYMENT"/>
				<result property="proLocation" column="LOCATION"/>
				<result property="proRecruit" column="RECRUIT"/>
				<result property="proCreateDate" column="CDATE"/>
			</association>
			
		</association>
		
		<collection property="portfolio" javaType="java.util.ArrayList" resultMap="applyPFResultSet"/>
		<collection property="answer" javaType="java.util.ArrayList" resultMap="AnswerResultSet" />
	
	</resultMap>
	
	<resultMap type="CPeval" id="cpEvalListResult">
  	<id property="eId" column="E_ID"/>
  	<result property="proName" column="PRO_NAME"/>
  	<result property="mcId" column="MC_ID"/>
  	<result property="dcType" column="DC_TYPE"/>
  	<result property="eWriter" column="E_WRITER"/>
  	<result property="eTarget" column="E_TARGET"/>
  	<result property="epId" column="EP_ID"/>
  	<result property="eAgv" column="E_AGV"/>
  	<result property="eContent" column="E_CONTENT"/>
  	<result property="star1" column="E_STAR1"/>
  	<result property="star2" column="E_STAR2"/>
  	<result property="star3" column="E_STAR3"/>
  	<result property="star4" column="E_STAR4"/>
  	<result property="star5" column="E_STAR5"/>
  	<result property="eCreateDate" column="E_CREATE_DATE"/>
  	<result property="eStatus" column="E_STATUS"/>
  </resultMap>


	<insert id = "addProject" parameterType ="Project">
		INSERT INTO PROJECT VALUES(
			SEQ_PRO_ID.NEXTVAL
			,#{memId}
			,#{proName}
			,#{proMaintain}
			,'PST2'
			,DEFAULT
			,SYSDATE
			,#{proPlan}
			,#{proPlanDetail}
			,#{proSummary}
			,#{proNeeds}
			,#{proNeedsDetail}
			,#{proResource}
			,#{proPayment}
			,#{proStartDate}
			,#{proDuration}
			,#{proREndDate}
			,#{proEndDate}
			,#{proMCId}
			,#{proDCId}
			,#{proWTId}
			,#{proRecruitNum}
			,#{proPlanPaper}
			,#{proPlanRePaper}
			,#{proLocation}
			,#{proHelp}
			,#{proManage}
			,#{proFuturePlan}
			,#{proPriority}
			,NULL
			,#{proTypeCode}
			,NULL
			,1  <!-- 날인ID -->
			,'N'
			,SEQ_PRO_ID.CURRVAL
			
		)
			</insert>

<insert id ="addQuestion" parameterType ="ProjectQuestion">
	INSERT INTO P_QUESTION VALUES (
	SEQ_PRO_AQ_ID.NEXTVAL
	,#{proAQContent}
	,SYSDATE
	,(SELECT MAX(PRO_ID) FROM PROJECT)
	,'N'
	)
	
	</insert>
	
<insert id ="temStoreProject" parameterType = "Project">
	INSERT INTO PROJECT VALUES(
			SEQ_PRO_ID.NEXTVAL
	,#{memId}
   
		<choose>
    <when test ="proName == ''">
    	,'***프로젝트 명을 작성해주세요 ***'
    </when>
    <otherwise>
		,#{proName}     
    </otherwise>
   </choose>
 
		<choose>
    <when test ="proMaintain == ''">
    	,DEFAULT
    </when>
    <otherwise>
		,#{proMaintain}     
    </otherwise>
   </choose>    
     
   ,'PST7'
   ,DEFAULT
   ,SYSDATE 
			<choose>
    <when test ="proPlan == ''">
    	,'1'
    </when>
    <otherwise>
		,#{proPlan}     
    </otherwise>
   </choose>
			,#{proPlanDetail}
			,#{proSummary}
			,#{proNeeds}
			,#{proNeedsDetail}
			,#{proResource}
			,#{proPayment}
			,#{proStartDate}
			,#{proDuration}
			,#{proREndDate}
			,#{proEndDate}
			,#{proMCId}
			,#{proDCId}
			,#{proWTId}
			,#{proRecruitNum}
			,#{proPlanPaper}
			,#{proPlanRePaper}
			,#{proLocation}
			,#{proHelp}
			,#{proManage}
			,#{proFuturePlan}
			,#{proPriority}
			,NULL
			,#{proTypeCode}<!-- 삭제예상 -->
			,1  <!-- 날인ID -->
			,'N'
			,SEQ_PRO_ID.CURRVAL
			)
</insert>	
	
	<insert id ="temStoreQuestion" parameterType ="ProjectQuestion">
	INSERT INTO P_QUESTION VALUES (
	SEQ_PRO_AQ_ID.NEXTVAL
	,#{proAQContent}
	,SYSDATE
	,(SELECT MAX(PRO_ID) FROM PROJECT)
	,'Y'
	)
	
	</insert>
	
	<select id ="selectOne" parameterType ="int" resultMap ="projectResultSet">
		SELECT * 
		FROM PROJECT
		WHERE PRO_ID = #{proId}
	</select>
	
	<select id ="selectCommitList"  resultMap ="projectResultSet">
		SELECT * 
		FROM CHK_PRO
		WHERE PRO_STA_ID ='PST2'
	</select>
	
	
	<update id ="applyUpdate"  parameterType ="ApplyConfirm">
	UPDATE P_APPLY
	SET PRO_ASTATUS = '1'
	WHERE MEM_PID = #{memPId}
	</update> 
	<update id ="rejectApply" parameterType ="ApplyConfirm">
		UPDATE P_APPLY
	SET PRO_ASTATUS = '2'
	WHERE MEM_PID = #{memPId}
	
	</update>
	<update id ="commitProject"  parameterType ="Project">
	UPDATE PROJECT
	SET PRO_STA_ID = 'PST3'
	WHERE PRO_ID = #{proId}
	</update>
	
	<select id ="selectApplyList"  parameterType ="int" resultMap ="applyConfirmResultSet">
	SELECT *
	FROM P_APPLY A
	LEFT JOIN MEMBER M ON(A.MEM_PID =M.MEM_ID)
	LEFT JOIN PROJECT P ON (A.PRO_ID=P.PRO_ID)
	LEFT JOIN PORT_APPLY PA ON(A.PRO_ID=PA.PRO_AID)
	LEFT JOIN PORTFOLIO PF ON( PA.PORT_ID =PF.PORT_ID)
	LEFT JOIN PROFILE PRF ON (PF.PROFILE_ID= PRF.PROFILE_ID)
	WHERE P.PRO_ID = #{proId} AND A.PRO_ASTATUS = '0'
	
	</select>
	
	
	<select id="getRecuritNum" resultType="_int">
	SELECT PRO_RECRUIT_NUM
	FROM PROJECT
    where PRO_ID =#{proId}
</select>

<select id="getCommitListCount" resultType="_int">
	SELECT COUNT(*) 
	FROM P_APPLY
    where PRO_ID =#{proId} AND PRO_ASTATUS ='1'
</select>

	<select id ="temUpdateForm" parameterType ="int" resultMap ="projectResultSet">
			SELECT * 
		FROM PROJECT
		WHERE PRO_ID = #{proId}
	</select>
		
		<select id ="temStoreList" parameterType ="int" resultMap ="projectResultSet"> 
			SELECT * 
			FROM CHK_PRO
			WHERE MEM_ID=#{a} AND PRO_STA_ID = 'PST7'
			ORDER BY PRO_ID DESC
		</select>
		
	<update id ="updateProject"  parameterType ="Project">
	UPDATE PROJECT
	SET PRO_NAME = #{proName}
		,PRO_MAINTAIN = #{proMaintain}
		,PRO_PLAN = #{proPlan}
		,PRO_PLANDETAIL = #{proPlanDetail}
		,PRO_SUMMARY = #{proSummary}
		,PRO_NEEDS = #{proNeeds}
		,PRO_NEEDSDETAIL = #{proNeedsDetail}
		,PRO_RESOURCE = #{proResource}
		,PRO_PAYMENT = #{proPayment}
		,PRO_START_DATE = #{proStartDate}
		,PRO_DURATION = #{proDuration}
		,PRO_R_END_DATE =#{proREndDate}
		,PRO_END_DATE =#{proREndDate}
		,MC_ID =#{proMCId}
		,DC_ID = #{proDCId}
		,WT_ID = #{proWTId}
		,PRO_RECRUIT_NUM = #{proRecruitNum}
		,PRO_PLAN_PAPER =#{proPlanPaper}
		,PRO_PLAN_REPAPER = #{proPlanRePaper}
		,PRO_LOCATION = #{proLocation}
		,PRO_HELP = #{proHelp}
		,PRO_MANAGE = #{proManage}
		,PRO_FUTUREPLAN =#{proFuturePlan}
		,PRO_PRIORTY = #{proPriority}
		,PRO_STA_ID ='PST2'
		,MEM_TYPE_CODE = #{proTypeCode}
		WHERE PRO_ID=#{proId}
	</update>
	

	<update id ="updateQuestion"  parameterType ="ProjectQuestion">
	UPDATE P_QUESTION
		SET PRO_AQ_CONTENT = #{proAQContent}
			,PRO_AQC_DATE =SYSDATE

	</update>
	
	<delete id ="deleteProject" parameterType ="Project">
	UPDATE SET 
		PRO_STA_ID = 'PST6'
	WHERE PRO_ID = #{proId}
	
	</delete>
	
	<delete id ="deleteQuestion" parameterType ="ProjectQuestion">
	DELETE FROM P_QUESTION
	WHERE PRO_ID = #{proId}
	
	</delete>

	<select id ="getQuestion" parameterType ="int" resultMap ="projectQuestionResultSet"> 
		SELECT * 
		FROM P_QUESTION
		WHERE PRO_ID = #{proId}
	</select>
	
<select id = "selectCheckList" resultMap="projectResultSet">
	SELECT * 
	FROM CHK_PRO
	WHERE MEM_ID= #{memId} AND PRO_STA_ID = 'PST2'
	ORDER BY PRO_ID DESC
</select>
<select id="getCheckListCount" resultType="_int">
	SELECT COUNT(*) 
	FROM CHK_PRO
    where pro_sta_id ='PST2' AND MEM_ID =#{memId}
</select>

<select id ="selectrecruitList" resultMap="projectResultSet">
	SELECT * 
	FROM CHK_PRO
	WHERE MEM_ID= #{memId} AND PRO_STA_ID = 'PST3'
	ORDER BY PRO_ID DESC
</select>


<select id ="underwayList" resultMap = "projectResultSet">
	SELECT * 
	FROM CHK_PRO
	WHERE MEM_ID= #{memId1} AND PRO_STA_ID = 'PST4'
	ORDER BY PRO_ID DESC
</select>

<select id = "selectendList" resultMap = "projectResultSet">
	SELECT * 
	FROM PROJECT
	WHERE MEM_ID= 2 AND PRO_STA_ID = 'PST5'
	ORDER BY PRO_ID DESC
</select>

<select id="getListCountNoFilter" resultType="_int">
	SELECT COUNT(DISTINCT(ID)) 
	FROM PROJECTLIST_VIEW
</select>

<select id="getProjectListNoFilter" resultMap="projectListResultSet">
	SELECT * 
	FROM PROJECTLIST_VIEW 
	ORDER BY 1 DESC
</select>

<select id="getListCountWithSearch" parameterType="Search" resultType="_int" >
	SELECT COUNT(DISTINCT(ID)) 
	FROM PROJECTLIST_VIEW P
	LEFT JOIN PROJECTTECH_VIEW T ON (P.ID=T.PRO_ID)
	<where>
	<if test="category=='전체'">
	OR NAME LIKE '%'||#{keyword}||'%'
	OR TECH_NAME LIKE '%'||#{keyword}||'%'
	OR SUMMARY LIKE '%'||#{keyword}||'%'
	</if>
	<if test="category=='제목'">
	AND NAME LIKE '%'||#{keyword}||'%'
	</if>
	<if test="category=='관련기술'">
	AND TECH_NAME LIKE '%'||#{keyword}||'%'
	</if>
	<if test="category=='프로젝트 상세'">
	AND SUMMARY LIKE '%'||#{keyword}||'%'
	</if>
	</where>

</select> 

<select id="getProjectListWithSearch" parameterType="Search" resultMap="projectListResultSet">
	SELECT DISTINCT P.*
	FROM PROJECTLIST_VIEW P
	LEFT JOIN PROJECTTECH_VIEW T ON (P.ID=T.PRO_ID)
	<where>
	<if test="category=='전체'">
	OR NAME LIKE '%'||#{keyword}||'%'
	OR TECH_NAME LIKE '%'||#{keyword}||'%'
	OR SUMMARY LIKE '%'||#{keyword}||'%'
	</if>
	<if test="category=='제목'">
	AND NAME LIKE '%'||#{keyword}||'%'
	</if>
	<if test="category=='관련기술'">
	AND TECH_NAME LIKE '%'||#{keyword}||'%'
	</if>
	<if test="category=='프로젝트 상세'">
	AND SUMMARY LIKE '%'||#{keyword}||'%'
	</if>
	</where>
	ORDER BY 1 DESC

</select>
		
<select id="getListCount" parameterType="Filter" resultType="_int">
	SELECT COUNT(DISTINCT(ID)) 
	FROM PROJECTLIST_VIEW P
	LEFT JOIN PROJECTTECH_VIEW T ON (P.ID=T.PRO_ID)
	<where>
	<if test="workType!=null and workType.size>0">
	AND P.WORKTYPE IN
	<foreach item="item" collection="workType"  open="(" close=")" separator=",">
	#{item}
	</foreach>
	</if>
	<if test="mCate!=null and mCate.size>0">
	AND P.MCATEGORY IN
	<foreach item="item" collection="mCate"  open="(" close=")" separator=",">
	#{item}
	</foreach>
	</if>
	<if test="dCate!=null and dCate.size>0">
	AND P.DCATEGORY IN
	<foreach item="item" collection="dCate"  open="(" close=")" separator=",">
	#{item}
	</foreach>
	</if>
	<if test="costMin!=null and costMin!=''">
	AND <![CDATA[P.PAYMENT >= #{costMin}]]>
	</if>
	<if test="costMax!=null and costMax!=''">
	AND <![CDATA[P.PAYMENT <= #{costMax}]]>
	</if>
	<if test="rate!=null">
	AND <![CDATA[ P.EVALUATION >= #{rate}]]>
	</if>
	<if test="sign!=null">
	AND P.IDENTIFY=#{sign}
	</if>
	<if test="location!=null and location.size>0">
	AND P.LOCATION IN
	<foreach item="item" collection="location"  open="(" close=")" separator=",">
	#{item}
	</foreach>
	</if>
	<if test="recruit!=null">
	AND P.RECRUIT='Y'
	</if>
	<if test="search.keyword!=null">
	<if test="search.category=='전체'">
	AND
	(P.NAME LIKE '%'||#{search.keyword}||'%'
	 OR T.TECH_NAME LIKE '%'||#{search.keyword}||'%'
	 OR P.SUMMARY LIKE '%'||#{search.keyword}||'%')
	</if>
	<if test="search.category=='제목'">
	AND P.NAME LIKE '%'||#{search.keyword}||'%'
	</if>
	<if test="search.category=='관련기술'">
	AND T.TECH_NAME LIKE '%'||#{search.keyword}||'%'
	</if>
	<if test="search.category=='프로젝트 상세'">
	AND P.SUMMARY LIKE '%'||#{search.keyword}||'%'
	</if>
	</if>
	</where>
	
</select>
	
<select id="getProjectList" parameterType="Filter" resultMap="projectListResultSet">
		SELECT DISTINCT P.*
		FROM PROJECTLIST_VIEW P
		LEFT JOIN PROJECTTECH_VIEW T ON (P.ID=T.PRO_ID)
		<where>
		<if test="workType!=null and workType.size>0">
		AND P.WORKTYPE IN
		<foreach item="item" collection="workType"  open="(" close=")" separator=",">
		#{item}
		</foreach>
		</if>
		<if test="mCate!=null and mCate.size>0">
		AND P.MCATEGORY IN
		<foreach item="item" collection="mCate"  open="(" close=")" separator=",">
		#{item}
		</foreach>
		</if>
		<if test="dCate!=null and dCate.size>0">
		AND P.DCATEGORY IN
		<foreach item="item" collection="dCate"  open="(" close=")" separator=",">
		#{item}
		</foreach>
		</if>
		<if test="costMin!=null and costMin!=''">
		AND <![CDATA[P.PAYMENT >= #{costMin}]]>
		</if>
		<if test="costMax!=null and costMax!=''">
		AND <![CDATA[P.PAYMENT <= #{costMax}]]>
		</if>
		<if test="rate!=null">
		AND <![CDATA[ P.EVALUATION >= #{rate}]]>
		</if>
		<if test="sign!=null">
		AND P.IDENTIFY=#{sign}
		</if>
		<if test="location!=null and location.size>0">
		AND P.LOCATION IN
		<foreach item="item" collection="location"  open="(" close=")" separator=",">
		#{item}
		</foreach>
		</if>
		<if test="recruit!=null">
		AND P.RECRUIT='Y'
		</if>
		<if test="search.keyword!=null">
		<if test="search.category=='전체'">
		AND
		(P.NAME LIKE '%'||#{search.keyword}||'%'
		OR T.TECH_NAME LIKE '%'||#{search.keyword}||'%'
		OR P.SUMMARY LIKE '%'||#{search.keyword}||'%')
		</if>
		<if test="search.category=='제목'">
		AND P.NAME LIKE '%'||#{search.keyword}||'%'
		</if>
		<if test="search.category=='관련기술'">
		AND T.TECH_NAME LIKE '%'||#{search.keyword}||'%'
		</if>
		<if test="search.category=='프로젝트 상세'">
		AND P.SUMMARY LIKE '%'||#{search.keyword}||'%'
		</if>
		</if>
		</where>
		
		<if test="sorting!=null">
		
		<choose>
		<when test="sorting=='APPLYNUM'">
		ORDER BY 11 DESC
		</when>
		<when test="sorting=='PAYMENT'">
		ORDER BY 6 DESC
		</when>
		<when test="sorting=='CDATE'">
		ORDER BY 9 DESC
		</when>
		<when test="sorting=='RENDDATE'">
		ORDER BY 10 ASC
		</when>
		<when test="sorting=='LIKENUM'">
		ORDER BY 12 DESC
		</when>
		
		
		</choose>
		
		
		</if>
		
		<if test="sorting=null">
		ORDER BY 1 DESC
		</if>
		
</select>
	
	<select id="getTechList" resultMap="techResultSet">
		SELECT * FROM PROJECTTECH_VIEW
	</select>
	
	<select id="getProjectDetail" parameterType="int" resultMap="detailResultSet">
		SELECT P.*,PJ.*,M.MEM_NICK AS "CLIENTNICK",INTRODUCTION,PRO_AQ_ID,PRO_AQ_CONTENT,PRO_AQC_DATE,
		RP.PRO_RID AS "RP_RID",RP.PRO_ID AS "RP_PID",RP.PRO_RCONTENT AS "RP_CONTENT",RP.PRO_RCREATE_DATE AS "RP_CDATE",RP.PRO_RMODIFY_DATE AS "RP_MDATE",
		RP.PRO_RANSWER AS "RP_RANSWER",RP.PRO_RSTATUS AS "RP_STATUS",RP.PRO_PARENT_RID AS "RP_P_RID",RP.PRO_RSECRET AS "RP_SECRET",
		MP.MEM_NICK AS "RP_MNICK",MP.MEM_ID AS "RP_MID",
		RC.PRO_RID AS "RC_RID",RC.PRO_ID AS "RC_PID",RC.PRO_RCONTENT AS "RC_CONTENT",RC.PRO_RCREATE_DATE AS "RC_CDATE",RC.PRO_RMODIFY_DATE AS "RC_MDATE",
		RC.PRO_RANSWER AS "RC_RANSWER",RC.PRO_RSTATUS AS "RC_STATUS",RC.PRO_PARENT_RID AS "RC_P_RID",RC.PRO_RSECRET AS "RC_SECRET",
		MC.MEM_NICK AS "RC_MNICK",MC.MEM_ID AS "RC_MID",
		T_NAME AS "TECH_NAME"
		FROM PROJECTLIST_VIEW P
		LEFT JOIN PROJECT PJ ON (P.ID=PJ.PRO_ID)
        LEFT JOIN MEMBER M ON (PJ.MEM_ID=M.MEM_ID)
		LEFT JOIN P_QUESTION Q ON(P.ID=Q.PRO_ID)
		LEFT JOIN (SELECT *
		FROM P_REPLY
		WHERE PRO_RID = PRO_PARENT_RID AND PRO_RSTATUS='N') RP ON (P.ID=RP.PRO_ID)
		LEFT JOIN (SELECT *
		FROM P_REPLY
		WHERE PRO_RID != PRO_PARENT_RID AND PRO_RSTATUS='N') RC ON (P.ID=RC.PRO_ID)
		LEFT JOIN MEMBER MP ON (RP.MEM_ID=MP.MEM_ID)
		LEFT JOIN MEMBER MC ON (RC.MEM_ID=MC.MEM_ID)
		LEFT JOIN PROFILE F ON (PJ.MEM_ID=F.MEM_ID)
		LEFT JOIN P_TEC PT ON (P.ID=PT.PRO_ID)
		LEFT JOIN TECH T ON (PT.T_ID=T.T_ID)
		WHERE P.ID=#{id}
		ORDER BY PRO_AQ_ID
	</select>
	
	<select id="getProjectNumber" parameterType="int" resultMap="pNumberResultSet">
		SELECT *
		FROM(SELECT COUNT(*) AS "ALL"
		FROM PROJECT
		WHERE MEM_ID=#{memId})
		CROSS JOIN (SELECT COUNT(*) AS "PROCESS"
		FROM PROJECT
		WHERE MEM_ID=#{memId} AND PRO_STA_ID='PST4')
		CROSS JOIN (SELECT COUNT(*) AS "COMPLETE"
		FROM PROJECT
		WHERE MEM_ID=#{memId} AND PRO_STA_ID IN ('PST5','PST6'))
		CROSS JOIN (SELECT SUM(PRO_PAYMENT) AS "TOTAL"
		FROM PROJECT
		WHERE MEM_ID=#{memId} AND PRO_STA_ID IN ('PST5','PST6'))
		CROSS JOIN (SELECT COUNT(*) AS "EVALCOUNT"
		FROM EVAL
		WHERE E_TARGET=#{memId})
	</select>
	
	<select id="getRecommend" parameterType="ProjectList" resultMap="RecommendResultSet">
		SELECT P.*,T_NAME AS "TECH_NAME"
		FROM PROJECTLIST_VIEW P
		LEFT JOIN P_TEC PT ON (P.ID=PT.PRO_ID)
		LEFT JOIN TECH T ON (PT.T_ID=T.T_ID)
		WHERE MCATEGORY=#{mCategory} AND DCATEGORY=#{dCategory} AND ID !=#{id}
		ORDER BY CDATE DESC
	</select>
	
	<insert id="insertProjectReply" parameterType="Reply">
	
		INSERT INTO P_REPLY VALUES
		(SEQ_RID.NEXTVAL,#{pId},#{writer.memId},#{rContent},SYSDATE,SYSDATE,'N','N',SEQ_RID.CURRVAL,#{rSecret})
	
	</insert>
	
	<select id="selectPReply" parameterType="int" resultMap="pReplyResultSet">
		SELECT RP.PRO_RID AS "RP_RID",
		RP.PRO_ID AS "RP_PID",
		RP.PRO_RCONTENT AS "RP_CONTENT",
		RP.PRO_RCREATE_DATE AS "RP_CDATE",
		RP.PRO_RMODIFY_DATE AS "RP_MDATE",
		RP.PRO_RANSWER AS "RP_RANSWER",
		RP.PRO_RSTATUS AS "RP_STATUS",
		RP.PRO_PARENT_RID AS "RP_P_RID",
		RP.PRO_RSECRET AS "RP_SECRET",
		M.MEM_NICK AS "RP_MNICK",
		M.MEM_ID AS "RP_MID"
		FROM P_REPLY RP
		LEFT JOIN MEMBER M ON (RP.MEM_ID=M.MEM_ID) 
		WHERE PRO_ID=#{pId} AND PRO_RID = PRO_PARENT_RID AND PRO_RSTATUS='N'
	</select>
	
	<select id="selectCReply" parameterType="int" resultMap="cReplyResultSet" >
		SELECT RC.PRO_RID AS "RC_RID",
		RC.PRO_ID AS "RC_PID",
		RC.PRO_RCONTENT AS "RC_CONTENT",
		RC.PRO_RCREATE_DATE AS "RC_CDATE",
		RC.PRO_RMODIFY_DATE AS "RC_MDATE",
		RC.PRO_RANSWER AS "RC_RANSWER",
		RC.PRO_RSTATUS AS "RC_STATUS",
		RC.PRO_PARENT_RID AS "RC_P_RID",
		RC.PRO_RSECRET AS "RC_SECRET",
		M.MEM_NICK AS "RC_MNICK",
		M.MEM_ID AS "RC_MID"
		FROM P_REPLY RC
		LEFT JOIN MEMBER M ON (RC.MEM_ID=M.MEM_ID) 
		WHERE PRO_ID=#{pId} AND PRO_RID != PRO_PARENT_RID AND PRO_RSTATUS='N'
	
	</select>
	
	<update id="updateProjectReply" parameterType="Reply">
		UPDATE P_REPLY SET
		PRO_RCONTENT=#{rContent},PRO_RMODIFY_DATE=SYSDATE,
		PRO_RSECRET=#{rSecret}
		WHERE PRO_RID=#{rId}
	</update>
	
	<update id="deleteProjectReply" parameterType="Reply">
		UPDATE P_REPLY SET
		PRO_RSTATUS='Y'
		WHERE PRO_RID=#{rId}
	</update>
	
	<update id="updateAnswerStatus" parameterType="Reply">
		UPDATE P_REPLY SET
		PRO_RANSWER='N'
		WHERE PRO_RID=#{parentRId}
	</update>
	
	<insert id="answerProjectReply" parameterType="Reply">
		INSERT INTO P_REPLY VALUES
		(SEQ_RID.NEXTVAL,#{pId},#{writer.memId},#{rContent},SYSDATE,SYSDATE,'N','N',#{parentRId},#{rSecret})
	</insert>
	
	<update id="changeAnswerStatus" parameterType="Reply">
		UPDATE P_REPLY SET
		PRO_RANSWER='Y'
		WHERE PRO_RID=#{parentRId}
	</update>
	
	<select id="checkLikeNum" parameterType="hashmap" resultType="_int">
		SELECT COUNT(*)
        FROM P_LIKE
        WHERE PRO_ID=#{pId} AND MEM_ID=#{memId}
	</select>
	
	<insert id="addLikeProject">
		INSERT INTO P_LIKE VALUES
		(SEQ_LIKEID.NEXTVAL,#{memId},#{pId},SYSDATE)
	</insert>
	
	<select id="getLikeCount" parameterType="hashmap" resultType="_int">
		SELECT COUNT(*)
		FROM P_LIKE L
		LEFT JOIN PROJECTLIST_VIEW P ON (L.PRO_ID=P.ID)
		WHERE L.MEM_ID=#{memId}
		<if test="keyword!=null and category!=null">
		<choose>
		<when test="category=='전체'">
		AND (NAME LIKE '%'||#{keyword}||'%' OR SUMMARY LIKE '%'||#{search}||'%')
		</when>
		<when test="category=='제목'">
		AND NAME LIKE '%'||#{keyword}||'%'
		</when>
		<when test="category=='프로젝트내용'">
		AND SUMMARY LIKE '%'||#{keyword}||'%'
		</when>
		</choose>
		</if>
	</select>
	
	<select id="getLikeList" parameterType="hashmap" resultMap="likeResultSet">
		SELECT L.*,P.*,M.MEM_NICK,M.MEM_EMAIL
		FROM P_LIKE L
		LEFT JOIN PROJECTLIST_VIEW P ON (L.PRO_ID=P.ID)
		LEFT JOIN MEMBER M ON (L.MEM_ID=M.MEM_ID)
		WHERE L.MEM_ID=#{memId}
		
		<if test="keyword!=null and category!=null">
		<choose>
		<when test="category=='전체'">
		AND (NAME LIKE '%'||#{keyword}||'%' OR SUMMARY LIKE '%'||#{search}||'%')
		</when>
		<when test="category=='제목'">
		AND NAME LIKE '%'||#{keyword}||'%'
		</when>
		<when test="category=='프로젝트내용'">
		AND SUMMARY LIKE '%'||#{keyword}||'%'
		</when>
		</choose>
		</if>
		
		<if test="sorting!=null">
		<choose>
		<when test="sorting =='PAYMENT'">
		ORDER BY 10 DESC
		</when>
		<when test="sorting =='CDATE'">
		ORDER BY 13 DESC
		</when>
		<when test="sorting =='RENDDATE'">
		ORDER BY 14 ASC
		</when>
		</choose>
		</if>
		
	</select>
	
	<delete id="deleteLikeProject" parameterType="int">
		DELETE FROM P_LIKE
		WHERE PRO_LID=#{lId}
	</delete>
	
	<select id="selectPortfolio" parameterType="int" resultMap="portfolioResultSet">
		SELECT PF.*, F.MEM_ID, PORT_IMG_ID,PORT_IMG_CONTENT,PORT_IMG_PATH
		FROM PORTFOLIO PF
		LEFT JOIN PORT_IMG I ON (PF.PORT_ID=I.PORT_ID)
		LEFT JOIN PROFILE F ON (PF.PROFILE_ID=F.PROFILE_ID)
		LEFT JOIN MEMBER M ON (F.MEM_ID=M.MEM_ID)
		WHERE F.MEM_ID=#{memId}
	 </select>

	<select id="findPortfolio" parameterType="hashmap" resultMap="portfolioResultSet">
	SELECT PF.*, F.MEM_ID, PORT_IMG_ID,PORT_IMG_CONTENT
	FROM PORTFOLIO PF
	LEFT JOIN PORT_IMG I ON (PF.PORT_ID=I.PORT_ID)
	LEFT JOIN PROFILE F ON (PF.PROFILE_ID=F.PROFILE_ID)
	LEFT JOIN MEMBER M ON (F.MEM_ID=M.MEM_ID)
	
	<where>
	<if test="memId !=null">
	AND F.MEM_ID=#{memId}
	</if>
		
	<if test="mCate == 'MC1'">
	AND MC_ID=#{mCate}
	</if>
	
	<if test="mCate == 'MC2'">
	AND MC_ID=#{mCate}
	</if>
	
	<if test="mCate == 'MC3'">
	AND MC_ID IN ('MC1','MC2')
	</if>
	
	<if test="dCate!=''">
	AND DC_ID=#{dCate}
	</if>
	</where>
	
	</select>
	
	
	<insert id="insertApplication" parameterType="Application">
	
	INSERT INTO P_APPLY VALUES(
		SEQ_APPLY.NEXTVAL,#{partner.memId},#{pId},#{aPayment},#{aDuration},#{aContent},#{originalResume},
		#{reNameResume},SYSDATE,'N','0')
	
	</insert>
	
	<insert id="insertApplyAnswer" parameterType="Answer">
	
	<selectKey resultType="int" keyProperty="aaId" order="BEFORE">
		SELECT NVL(MAX(PRO_AA_ID),0)+1 FROM P_ANSWER
	</selectKey>
	
	INSERT
	INTO P_ANSWER VALUES 
	(#{aaId},#{aaContent},SYSDATE,SEQ_APPLY.CURRVAL,#{aqId})
	</insert>
	
	<insert id="insertApplypofol" parameterType="ApplyPF">
	
	<selectKey resultType="int" keyProperty="apId" order="BEFORE">
		SELECT NVL(MAX(AP_ID),0)+1 FROM PORT_APPLY
	</selectKey>

	INSERT 
	INTO PORT_APPLY VALUES(#{apId},SEQ_APPLY.CURRVAL,#{portId},#{apContent})
	</insert>
	
	<select id="getApplyCount" parameterType="hashmap" resultType="_int">
	SELECT COUNT(*)
	FROM P_APPLY A
	LEFT JOIN PROJECTLIST_VIEW P ON (A.PRO_ID=P.ID)
	WHERE MEM_PID=#{memId} AND PRO_ASAVE_STATUS='N' AND PRO_ASTATUS='0'
	<if test="keyword!=null and category!=null">
	<choose>
	<when test="category=='전체'">
	AND (NAME LIKE '%'||#{keyword}||'%' OR SUMMARY LIKE '%'||#{search}||'%')
	</when>
	<when test="category=='제목'">
	AND NAME LIKE '%'||#{keyword}||'%'
	</when>
	<when test="category=='프로젝트내용'">
	AND SUMMARY LIKE '%'||#{keyword}||'%'
	</when>
	</choose>
	</if>
	</select>
	
	<select id="selectApplyProject" parameterType="hashmap" resultMap="applyResultSet">
		SELECT A.*,P.*,
		PRO_AA_ID,PRO_AA_CONTENT,PRO_AAC_DATE,
		W.PRO_AQ_ID AS "PRO_AQ_ID", PRO_AQ_CONTENT,
		PA.AP_ID AS "AP_ID",PA.PORT_ID AS "PORT_ID",AP_CONTENT,
		MC_ID,DC_ID,PROT_NAME,PORT_JOIN,PORT_START_DATE,PORT_END_DATE
		FROM P_APPLY A
		LEFT JOIN PROJECTLIST_VIEW P ON (A.PRO_ID=P.ID)
		LEFT JOIN P_ANSWER W ON (W.PRO_AID=A.PRO_AID)
		LEFT JOIN P_QUESTION Q ON (W.PRO_AQ_ID=Q.PRO_AQ_ID)
		LEFT JOIN PORT_APPLY PA ON (PA.PRO_AID=A.PRO_AID)
		LEFT JOIN PORTFOLIO F ON (PA.PORT_ID=F.PORT_ID)
		WHERE MEM_PID=#{memId} AND PRO_ASAVE_STATUS='N' AND PRO_ASTATUS='0'
		<if test="keyword!=null and category!=null">
		<choose>
		<when test="category=='전체'">
		AND (NAME LIKE '%'||#{keyword}||'%' OR SUMMARY LIKE '%'||#{search}||'%')
		</when>
		<when test="category=='제목'">
		AND NAME LIKE '%'||#{keyword}||'%'
		</when>
		<when test="category=='프로젝트내용'">
		AND SUMMARY LIKE '%'||#{keyword}||'%'
		</when>
		</choose>
		</if>
		
		<if test="sorting!=null">
		<choose>
		<when test="sorting =='PAYMENT'">
		ORDER BY 17 DESC
		</when>
		<when test="sorting =='CDATE'">
		ORDER BY 20 DESC
		</when>
		<when test="sorting =='RENDDATE'">
		ORDER BY 21 ASC
		</when>
		<otherwise>
		ORDER BY 1 DESC
		</otherwise>
		</choose>
		</if>
		
	</select>
	
	<select id="getTempSaveNum" parameterType="hashmap" resultType="_int">
		SELECT COUNT(*)
		FROM P_APPLY 
		WHERE MEM_PID=#{memId} AND PRO_ID=#{pId} AND PRO_ASAVE_STATUS='Y' AND PRO_ASTATUS='0'
	</select>
	
	<insert id="insertTempApplication" parameterType="hashmap">
	
		INSERT INTO P_APPLY VALUES(
		SEQ_APPLY.NEXTVAL,
		#{memId},
		#{pId},
		#{aPayment},
		#{aDuration},
		#{aContent},
		#{originalResume},
		#{reNameResume},
		SYSDATE,'Y','0')
	
	</insert>
	
	<select id="getTempId" parameterType="hashmap" resultType="_int">
		SELECT PRO_AID
		FROM P_APPLY 
		WHERE MEM_PID=#{memId} AND PRO_ID=#{pId} AND PRO_ASAVE_STATUS='Y' AND PRO_ASTATUS='0'
	</select>
	
	<update id="updateTempApplication" parameterType="hashmap"> 
		UPDATE P_APPLY
		SET PRO_APAYMENT=#{aPayment},
		PRO_ADURATION=#{aDuration},
		PRO_ACONTENT=#{aContent},
		PRO_ARESUME=#{originalResume},
		PRO_REARESUME=#{reNameResume}
		WHERE PRO_AID =#{aId}
	</update>
	
	<select id="isAnswerExist" parameterType="hashmap" resultType="_int">
		SELECT COUNT(*)
		FROM P_ANSWER
		WHERE PRO_AID=#{aId} AND PRO_AQ_ID=#{each.aqId}
	</select>
	
	<update id="updateTempAnswer" parameterType="hashmap">
		UPDATE P_ANSWER
		SET PRO_AA_CONTENT=#{each.aaContent},
		PRO_AAC_DATE=SYSDATE
		WHERE PRO_AID=#{aId} AND PRO_AQ_ID=#{each.aqId}
	</update>
	
	<select id="isPofoExist" parameterType="hashmap" resultType="_int">
		SELECT COUNT(*)
		FROM PORT_APPLY
		WHERE PRO_AID=#{aId} 
	</select>
	
	<delete id="deleteExistPofo" parameterType="hashmap">
		DELETE PORT_APPLY
		WHERE PRO_AID=#{aId}
	</delete>
	
	<insert id="insertTempAnswer" parameterType="Answer">
	
	<selectKey resultType="int" keyProperty="aaId" order="BEFORE">
		SELECT NVL(MAX(PRO_AA_ID),0)+1 FROM P_ANSWER
	</selectKey>
	
	INSERT
	INTO P_ANSWER VALUES 
	(#{aaId},#{aaContent},SYSDATE,#{aId},#{aqId})
	
	</insert>
	
	<insert id="insertTempPofo" parameterType="ApplyPF">
	
	<selectKey resultType="int" keyProperty="apId" order="BEFORE">
		SELECT NVL(MAX(AP_ID),0)+1 FROM PORT_APPLY
	</selectKey>

	INSERT 
	INTO PORT_APPLY VALUES(#{apId},#{proAId},#{portId},#{apContent})
	</insert>
	
	<select id="selectTempResume" parameterType="_int" resultMap="applyResultSet">
	SELECT *
	FROM P_APPLY
	WHERE PRO_AID=#{aId}
	</select>
	
	<select id="getTempApplyCount" parameterType="hashmap" resultType="_int">
	SELECT COUNT(*)
	FROM P_APPLY A
	LEFT JOIN PROJECTLIST_VIEW P ON (A.PRO_ID=P.ID)
	WHERE MEM_PID=#{memId} AND PRO_ASAVE_STATUS='Y' AND PRO_ASTATUS='0'
	<if test="keyword!=null and category!=null">
	<choose>
	<when test="category=='전체'">
	AND (NAME LIKE '%'||#{keyword}||'%' OR SUMMARY LIKE '%'||#{keyword}||'%')
	</when>
	<when test="category=='제목'">
	AND NAME LIKE '%'||#{keyword}||'%'
	</when>
	<when test="category=='프로젝트내용'">
	AND SUMMARY LIKE '%'||#{keyword}||'%'
	</when>
	</choose>
	</if>
	
	</select>
	
	<select id="selectTempApplyProject" parameterType="hashmap" resultMap="applyResultSet">
		SELECT A.*,P.*
		FROM P_APPLY A
		LEFT JOIN PROJECTLIST_VIEW P ON (A.PRO_ID=P.ID)
		WHERE MEM_PID=#{memId} AND PRO_ASAVE_STATUS='Y' AND PRO_ASTATUS='0'
		<if test="keyword!=null and category!=null">
		<choose>
		<when test="category=='전체'">
		AND (NAME LIKE '%'||#{keyword}||'%' OR SUMMARY LIKE '%'||#{keyword}||'%')
		</when>
		<when test="category=='제목'">
		AND NAME LIKE '%'||#{keyword}||'%'
		</when>
		<when test="category=='프로젝트내용'">
		AND SUMMARY LIKE '%'||#{keyword}||'%'
		</when>
		</choose>
		</if>
		
		<if test="sorting!=null">
		<choose>
		<when test="sorting =='PAYMENT'">
		ORDER BY 17 DESC
		</when>
		<when test="sorting =='CDATE'">
		ORDER BY 20 DESC
		</when>
		<when test="sorting =='RENDDATE'">
		ORDER BY 21 ASC
		</when>
		<otherwise>
		ORDER BY 1 DESC
		</otherwise>
		</choose>
		</if>
		
	</select>
	
	<select id="selectTempApplication" parameterType="_int" resultMap="applyResultSet">
		SELECT A.*,P.*,
		PRO_AA_ID,PRO_AA_CONTENT,PRO_AAC_DATE,
		W.PRO_AQ_ID AS "PRO_AQ_ID", PRO_AQ_CONTENT,
		PA.AP_ID AS "AP_ID",PA.PORT_ID AS "PORT_ID",AP_CONTENT,
		MC_ID,DC_ID,PROT_NAME,PORT_JOIN,PORT_START_DATE,PORT_END_DATE
		FROM P_APPLY A
		LEFT JOIN PROJECTLIST_VIEW P ON (A.PRO_ID=P.ID)
		LEFT JOIN P_ANSWER W ON (W.PRO_AID=A.PRO_AID)
		LEFT JOIN P_QUESTION Q ON (W.PRO_AQ_ID=Q.PRO_AQ_ID)
		LEFT JOIN PORT_APPLY PA ON (PA.PRO_AID=A.PRO_AID)
		LEFT JOIN PORTFOLIO F ON (PA.PORT_ID=F.PORT_ID)
		WHERE A.PRO_AID=#{aId} AND A.PRO_ASAVE_STATUS='Y' AND A.PRO_ASTATUS='0'
		
	</select>
	
	<update id="deleteTempApplication" parameterType="Application">
		UPDATE P_APPLY
		SET PRO_ASTATUS='3'
		WHERE MEM_PID=#{partner.memId} AND PRO_ID=#{pId} AND PRO_ASAVE_STATUS='Y' 
	</update>
	
	<update id="cancelThisApply" parameterType="_int">
		UPDATE P_APPLY
		SET PRO_ASTATUS='3'
		WHERE PRO_AID=#{aId}
	</update>
	
	<update id="cancelTempApply" parameterType="_int">
		UPDATE P_APPLY
		SET PRO_ASTATUS='3'
		WHERE PRO_AID=#{aId}
	</update>
	
	
	<select id="checkApplyCount" parameterType="hashmap" resultType="_int">
	SELECT COUNT(*)
	FROM P_APPLY
	WHERE PRO_ID=#{pId} AND MEM_PID=#{memId} AND PRO_ASAVE_STATUS='N' AND PRO_ASTATUS=0
	
	</select>
	
	<select id="checkTempApplyCount" parameterType="hashmap" resultType="_int">
	SELECT COUNT(*)
	FROM P_APPLY
	WHERE PRO_ID=#{pId} AND MEM_PID=#{memId} AND PRO_ASAVE_STATUS='Y' AND PRO_ASTATUS=0
	</select>
	
	<select id="checkSigCount" parameterType="hashmap" resultType="_int">
	SELECT COUNT(*)
	FROM SIGNATURE
	WHERE MEM_ID=#{memId}
	</select>
	
	<select id="checkMatched" parameterType="hashmap" resultType="_int">
	SELECT COUNT(*)
	FROM P_APPLY
	WHERE PRO_ID=#{pId} AND MEM_PID=#{memId} AND PRO_ASTATUS=1
	</select>
	
	<select id="selectUserLike" parameterType="_int" resultMap="likeResultSet">
	SELECT PRO_LID, ID, M.MEM_ID AS "MEM_ID"
	FROM P_LIKE L
	LEFT JOIN PROJECTLIST_VIEW P ON (L.PRO_ID=P.ID)
	LEFT JOIN MEMBER M ON (L.MEM_ID=M.MEM_ID)
	WHERE L.MEM_ID=#{memId}
	
	</select>
	
	<select id="getOngoingCount" parameterType="hashmap" resultType="_int">
	SELECT COUNT(*)
	FROM P_PROCESS C
	LEFT JOIN PROJECT P ON (C.PRO_ID=P.PRO_ID)
	LEFT JOIN MCATE M ON (P.MC_ID=M.MC_ID)
	LEFT JOIN DCATE D ON (P.DC_ID=D.DC_ID)
	LEFT JOIN P_MATCH CH ON (CH.PRO_PID=C.PRO_PID)
	WHERE P.PRO_STA_ID='PST4' AND CH.MEM_ID=#{memId}
	
	<if test="keyword!=null and category!=null">
		<choose>
		<when test="category=='전체'">
		AND (PRO_NAME LIKE '%'||#{keyword}||'%' OR PRO_SUMMARY LIKE '%'||#{keyword}||'%')
		</when>
		<when test="category=='제목'">
		AND PRO_NAME LIKE '%'||#{keyword}||'%'
		</when>
		<when test="category=='프로젝트내용'">
		AND PRO_SUMMARY LIKE '%'||#{keyword}||'%'
		</when>
		</choose>
	</if>
	
	
	</select>
	
	<select id="selectOngoingList" parameterType="hashmap" resultMap="projectListResultSet">
	SELECT c.pro_pid AS "ID",
	P.PRO_ID AS "PROID",P.PRO_NAME AS "NAME",P.PRO_DURATION AS "DURATION",
	P.PRO_PAYMENT AS "PAYMENT",P.PRO_LOCATION AS "LOCATION",P.PRO_CONTRACT AS "CONTRACT",
	M.MC_TYPE AS "MCATEGORY", D.DC_TYPE AS "DCATEGORY"
	,P.PRO_CREATE_DATE AS "CDATE",P.PRO_R_END_DATE AS "RENDDATE"
	FROM P_PROCESS C
	LEFT JOIN PROJECT P ON (C.PRO_ID=P.PRO_ID)
	LEFT JOIN MCATE M ON (P.MC_ID=M.MC_ID)
	LEFT JOIN DCATE D ON (P.DC_ID=D.DC_ID)
	LEFT JOIN P_MATCH CH ON (CH.PRO_PID=C.PRO_PID)
	WHERE P.PRO_STA_ID='PST4' AND CH.MEM_ID=#{memId}
	
	<if test="keyword!=null and category!=null">
		<choose>
		<when test="category=='전체'">
		AND (PRO_NAME LIKE '%'||#{keyword}||'%' OR PRO_SUMMARY LIKE '%'||#{keyword}||'%')
		</when>
		<when test="category=='제목'">
		AND PRO_NAME LIKE '%'||#{keyword}||'%'
		</when>
		<when test="category=='프로젝트내용'">
		AND PRO_SUMMARY LIKE '%'||#{keyword}||'%'
		</when>
		</choose>
	</if>
	
	<if test="sorting!=null">
		<choose>
		<when test="sorting =='PAYMENT'">
		ORDER BY 5 DESC
		</when>
		<when test="sorting =='CDATE'">
		ORDER BY 10 DESC
		</when>
		<when test="sorting =='RENDDATE'">
		ORDER BY 11 DESC
		</when>
		<otherwise>
		ORDER BY 1 DESC
		</otherwise>
		</choose>
	</if>
	
	
	</select>
	
	<select id="getCompleteCount" parameterType="hashmap" resultType="_int">
	SELECT COUNT(*)
	FROM P_PROCESS C
	LEFT JOIN PROJECT P ON (C.PRO_ID=P.PRO_ID)
	LEFT JOIN MCATE M ON (P.MC_ID=M.MC_ID)
	LEFT JOIN DCATE D ON (P.DC_ID=D.DC_ID)
	LEFT JOIN P_MATCH CH ON (CH.PRO_PID=C.PRO_PID)
	WHERE P.PRO_STA_ID IN ('PST5','PST6') AND CH.MEM_ID=#{memId}
	
	<if test="keyword!=null and category!=null">
		<choose>
		<when test="category=='전체'">
		AND (PRO_NAME LIKE '%'||#{keyword}||'%' OR PRO_SUMMARY LIKE '%'||#{keyword}||'%')
		</when>
		<when test="category=='제목'">
		AND PRO_NAME LIKE '%'||#{keyword}||'%'
		</when>
		<when test="category=='프로젝트내용'">
		AND PRO_SUMMARY LIKE '%'||#{keyword}||'%'
		</when>
		</choose>
	</if>
	<if test="sorting=='PST5'">
	AND P.PRO_STA_ID ='PST5'
	</if>
	<if test="sorting=='PST6'">
	AND P.PRO_STA_ID ='PST6'
	</if>
	
	</select>
	
	<select id="selectCompleteList" parameterType="hashmap" resultMap="projectListResultSet">
	SELECT c.pro_pid AS "ID",
	P.PRO_ID AS "PROID",P.PRO_NAME AS "NAME",P.PRO_DURATION AS "DURATION",
    P.PRO_STA_ID AS "STATUS",
	P.PRO_PAYMENT AS "PAYMENT",P.PRO_LOCATION AS "LOCATION",P.PRO_CONTRACT AS "CONTRACT",
	M.MC_TYPE AS "MCATEGORY", D.DC_TYPE AS "DCATEGORY",
	P.PRO_END_DATE, P.MEM_ID AS "CLIENTID", CAL.CAL_STATUS AS "CAL_STATUS"
	FROM P_PROCESS C
	LEFT JOIN PROJECT P ON (C.PRO_ID=P.PRO_ID)
	LEFT JOIN MCATE M ON (P.MC_ID=M.MC_ID)
	LEFT JOIN DCATE D ON (P.DC_ID=D.DC_ID)
	LEFT JOIN P_MATCH CH ON (CH.PRO_PID=C.PRO_PID)
    LEFT JOIN CALCULATE CAL ON (CAL.PRO_ID=P.PRO_ID)
	WHERE P.PRO_STA_ID IN ('PST5','PST6') AND CH.MEM_ID=#{memId}
	
	<if test="keyword!=null and category!=null">
		<choose>
		<when test="category=='전체'">
		AND (PRO_NAME LIKE '%'||#{keyword}||'%' OR PRO_SUMMARY LIKE '%'||#{keyword}||'%')
		</when>
		<when test="category=='제목'">
		AND PRO_NAME LIKE '%'||#{keyword}||'%'
		</when>
		<when test="category=='프로젝트내용'">
		AND PRO_SUMMARY LIKE '%'||#{keyword}||'%'
		</when>
		</choose>
	</if>
	<if test="sorting=='PST5'">
	AND P.PRO_STA_ID ='PST5'
	</if>
	<if test="sorting=='PST6'">
	AND P.PRO_STA_ID ='PST6'
	</if>
	
	<if test="sorting=='ENDDATE'">
	ORDER BY 11 DESC
	</if>
	
	</select>
	
	<select id="getRequestCount" parameterType="_int" resultType="_int">
	SELECT COUNT(*)
	FROM P_SUGGEST S
	LEFT JOIN PROJECT P ON (S.PRO_ID=P.PRO_ID)
	WHERE S.MEM_ID=#{memId} AND P.PRO_STA_ID='PST3'
	</select>
	
	<select id="selectSuggestList" parameterType="_int" resultMap="projectListResultSet">
	SELECT S.PS_ID AS "ID",
    P.PRO_ID AS "PROID",P.PRO_NAME AS "NAME",P.PRO_DURATION AS "DURATION",
    P.PRO_STA_ID AS "STATUS", P.PRO_RECRUIT AS "RECRUIT",
	P.PRO_PAYMENT AS "PAYMENT",P.PRO_LOCATION AS "LOCATION",
    P.PRO_CREATE_DATE AS "CDATE",
	M.MC_TYPE AS "MCATEGORY", D.DC_TYPE AS "DCATEGORY"
	FROM P_SUGGEST S
	LEFT JOIN PROJECT P ON (S.PRO_ID=P.PRO_ID)
	LEFT JOIN MCATE M ON (P.MC_ID=M.MC_ID)
	LEFT JOIN DCATE D ON (P.DC_ID=D.DC_ID)
	WHERE S.MEM_ID=#{memId} AND P.PRO_STA_ID='PST3'

	</select>
	
	<delete id="deleteThisSuggest" parameterType="_int">
	DELETE FROM P_SUGGEST
	WHERE PS_ID=#{sgId}
	</delete>


	<select id="selectLikeId" parameterType="hashmap" resultType="_int">
	SELECT MAX(PRO_LID)
	FROM P_LIKE
	</select>
	
	<select id="selectEvaluation" parameterType="hashmap" resultMap="cpEvalListResult">
	SELECT *
	FROM EVAL
	WHERE E_WRITER=#{memId}
	
	</select>

</mapper>
